<div class="overflow-x-auto p-8">
    <h2 class="font-extrabold text-2xl text-center">Products</h2>
    <table class="table-auto w-full border border-gray-300 mt-4">
        <thead>
            <tr>
                <th class="px-4 py-2 bg-gray-100 border-b">Nombre</th>
                <th class="px-4 py-2 bg-gray-100 border-b">Descripción</th>
                <th class="px-4 py-2 bg-gray-100 border-b">Precio</th>
                <th class="px-4 py-2 bg-gray-100 border-b">Categoría</th>
                <th class="px-4 py-2 bg-gray-100 border-b">Código</th>
                <th class="px-4 py-2 bg-gray-100 border-b">Stock</th>
            </tr>
        </thead>
        <tbody>
            {{#each products.docs}}
            <tr>
                <td class="px-4 py-2 border-b">{{this.title}}</td>
                <td class="px-4 py-2 border-b">{{this.description}}</td>
                <td class="px-4 py-2 border-b">${{this.price}}</td>
                <td class="px-4 py-2 border-b">{{this.category}}</td>
                <td class="px-4 py-2 border-b">{{this.code}}</td>
                <td class="px-4 py-2 border-b">{{this.stock}} unidades</td>
            </tr>
            {{/each}}
        </tbody>
    </table>

    <div class="flex justify-center mt-16 w-full">
        <nav class="inline-flex">
            {{#if products.hasPrevPage}}
           <button onclick="changePage({{products.prevPage}})" class="px-2 py-1 bg-blue-500 hover:bg-blue-700 text-black font-bold rounded-l">Previous</button>
            {{/if}}
            {{#if products.hasNextPage}}
            <button onclick="changePage({{products.nextPage}})" class="px-2 py-1 bg-blue-500 hover:bg-blue-700 text-black font-bold rounded-r">Next</a>
            {{/if}}
        </nav>
    </div>

    <div class="flex justify-center mt-4">
        <label for="limit" class="mr-2">Limit:</label>
        <input type="number" id="limit" name="limit" value="{{products.limit}}" onchange="applyLimit()" class="px-2 py-1 border border-gray-300 rounded">
        <button onclick="changeSort(1)" class="ml-4 bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">Sort Asc</button>
        <button onclick="changeSort(-1)" class="ml-2 bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">Sort Desc</button>
    </div>
</div>

<script>
    function changeSort(sortValue) {
        const urlParams = new URLSearchParams(window.location.search);
        urlParams.set('sort', sortValue);
        window.location.search = urlParams.toString();
    }

    function applyLimit() {
        const urlParams = new URLSearchParams(window.location.search);
        const getLimit = document.getElementById("limit")
        const limitInputValue = getLimit.value // 3
        urlParams.set('limit', limitInputValue);
        urlParams.set('page', 1);
        window.location.search = urlParams.toString();
    }

    function changePage(page) {
        const urlParams = new URLSearchParams(window.location.search);
        urlParams.set('page', page);
        window.location.search = urlParams.toString();
    }
</script>